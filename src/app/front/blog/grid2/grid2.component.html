<div class="page-wraper">
    <!-- Header -->
    <app-header-light3></app-header-light3>
    <!-- Header END -->

    <!-- Content -->
    <div class="page-content bg-gray">
      <!-- Inner Page Banner -->
      <app-banner1 [data]="banner"></app-banner1>
      <!-- Inner Page Banner END -->

      <div class="content-inner-2">
        <div class="container">
          <!-- Filtres et Recherche -->
          <div class="row mb-4 align-items-center">
            <div class="col-md-6">
              <!-- Menu dÃ©roulant pour filtrer par date -->
              <button type="button" mat-button class="btn btn-primary" [matMenuTriggerFor]="dateFilterMenu">
                Filtrer par date
              </button>
              <mat-menu #dateFilterMenu="matMenu" class="card-header-menu" xPosition="before">
                <button mat-menu-item (click)="filterByDate('today')">Aujourd'hui</button>
                <button mat-menu-item (click)="filterByDate('thisWeek')">Cette semaine</button>
                <button mat-menu-item (click)="filterByDate('thisMonth')">Ce mois-ci</button>
                <button mat-menu-item (click)="filterByDate('thisYear')">Cette annÃ©e</button>
              </mat-menu>
            </div>
            <div class="col-md-6 d-flex align-items-center justify-content-end">
              <!-- IcÃ´ne de notification -->
              <div class="notification-bell me-3">
                <div class="bell-icon" (click)="toggleNotifications()">
                  <span class="material-icons">notifications</span>
                  <span *ngIf="unreadNotificationsCount > 0" class="badge">
                    {{ unreadNotificationsCount }}
                  </span>
                </div>
                <!-- BoÃ®te dÃ©roulante des notifications -->
                
                <div *ngIf="showNotifications" class="notification-dropdown">
                    <div *ngFor="let notification of notifications" class="notification-item">
                    <div class="notification-icon">
                        <span *ngIf="notification.type === 'success'">ðŸŽ‰</span>
                        <span *ngIf="notification.type === 'error'">ðŸ˜¢</span>
                    </div>
                    <div class="notification-content">
                        <p>{{ notification.message }}</p>
                        <a *ngIf="notification.link" [routerLink]="notification.link">Voir l'entretien</a>
                        <button *ngIf="!notification.read" (click)="markAsRead(notification)" class="mark-as-read">
                        Marquer comme lu
                        </button>
                    </div>
                    </div>
                </div>
              </div>
              <!-- Champ de recherche pour filtrer par titre ou description -->
              <input type="text" class="form-control" placeholder="Rechercher par titre ou description" [(ngModel)]="searchQuery" (input)="applySearchFilter()">
            </div>
          </div>

          <!-- Grid View -->
          <div class="row">
            <div [ngClass]="{'col-xl-9 col-lg-8': layout.sidebar === true, 'col-xl-12 col-lg-12': layout.sidebar === false}">
              <div id="masonry" class="dlab-blog-grid-2">
                <div class="row">
                  <div class="post card-container {{ layout.gridClass }} mb-4" *ngFor="let item of displayedBlogs">
                    <div class="card shadow-sm h-100">
                      <!-- Card Image -->
                      <img *ngIf="item.image" [src]="item.image" class="card-img-top" alt="Blog Image">
                      <div class="card-body">
                        <!-- Card Title -->
                        <h5 class="card-title font-weight-bold">{{ item.title }}</h5>
                        <!-- Card Description -->
                        <div class="card-text text-muted" [ngClass]="{'expanded': selectedItem === item}">
                          {{ item.description || 'Pas de description disponible' }}
                        </div>
                        <!-- Lien "Read More" -->
                        <a *ngIf="item.description && item.description.length > 50" href="javascript:void(0);" (click)="showFullDescription(item)" class="text-primary">
                          {{ selectedItem === item ? 'Read Less' : 'Read More' }}
                        </a>
                        <!-- Posted Date -->
                        <p class="card-text">
                          <small class="text-muted">PubliÃ© le : {{ item.postedDate | date: 'dd/MM/yyyy' }}</small>
                        </p>
                        <!-- Status Badge -->
                        <span class="badge badge-pill"
                              [ngClass]="{'badge-success': item.status === 'OPEN', 'badge-danger': item.status === 'CLOSED'}">
                          {{ item.status === 'OPEN' ? 'Ouvert' : 'FermÃ©' }}
                        </span>
                        <!-- Details Button -->
                        <a [routerLink]="['/postuler', item.id]" class="btn btn-primary btn-block mt-3">
                          Postuler
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Grid View END -->

              <!-- Pagination -->
              <div class="pagination-bx clearfix m-b30 text-center">
                <ul class="pagination">
                  <!-- Bouton PrÃ©cÃ©dent -->
                  <li class="page-item previous" [class.disabled]="currentPage === 1">
                    <a class="page-link" href="javascript:void(0);" (click)="changePage(currentPage - 1)">
                      <i class="ti-arrow-left"></i> PrÃ©cÃ©dent
                    </a>
                  </li>
                  <!-- NumÃ©ros de page -->
                  <li class="page-item" *ngFor="let page of pages" [class.active]="page === currentPage">
                    <a class="page-link" href="javascript:void(0);" (click)="changePage(page)">
                      {{ page }}
                    </a>
                  </li>
                  <!-- Bouton Suivant -->
                  <li class="page-item next" [class.disabled]="currentPage === totalPages">
                    <a class="page-link" href="javascript:void(0);" (click)="changePage(currentPage + 1)">
                      Suivant <i class="ti-arrow-right"></i>
                    </a>
                  </li>
                </ul>
              </div>
              <!-- Pagination END -->
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Content END -->

    <!-- Footer -->
    <app-footer13></app-footer13>
    <!-- Footer END -->

    <!-- Scroll to Top Button -->
    <button class="scroltop fa fa-chevron-up" (click)="scroll_top()"></button>
  </div>
