<div class="page-wraper">
  <app-header-light3></app-header-light3>
  <div class="page-content bg-white">
      <div class="section-full content-inner overlay-black-dark" style="background-image:url(assets/images/background/bg1.jpg); background-position: 50% 50%;">
          <div class="container">
              <div class="row">
                  <div class="col-lg-5 text-center text-gray m-tb30">
                      <div class="dz_error">Negociation</div>
                  </div>

                  <div class="breadcrumb-card mb-25 d-md-flex align-items-center justify-content-between">
    <h5 class="mb-0">
      Chat
    </h5>
    <ol class="breadcrumb list-unstyled mt-0 mb-0 pl-0">
      <li class="breadcrumb-item position-relative">
        <a routerLink="/" class="d-inline-block position-relative">
          <i class="ri-home-8-line"></i>
          Dashboard
        </a>
      </li>
      <li class="breadcrumb-item position-relative">
        Apps
      </li>
      <li class="breadcrumb-item position-relative">
        Chat
      </li>
    </ol>
  </div>
  
  <div class="row">
    <div class="col-lg-3 col-md-6">
      <mat-card
        class="daxa-card mb-25 border-radius bg-white border-none d-block"
        [class.component-dark-theme]="themeService.isDark()"
        [class.rtl-enabled]="themeService.isRTLEnabled()"
      >
        <mat-card-header>
          <mat-card-title>
            <h5 class="mb-0">
              Documents
            </h5>
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>
          <div *ngIf="Documents && Documents.length > 0">
            <div *ngFor="let document of Documents" class="mb-3">
              <div class="text-center">
                <h6 class="mb-1">{{ document.nom }}</h6>
                <p class="text-muted">{{ document.typeDocument }}</p>
              </div>
              <div class="d-flex flex-wrap justify-content-center">
                <button
                  *ngIf="document.url"
                  mat-raised-button
                  color="primary"
                  class="me-2 mb-2"
                  (click)="openDocument(document.url)"
                >
                  Ouvrir le fichier
                </button>
              </div>
            </div>
          </div>
          <div *ngIf="Documents && Documents.length === 0 && !errorMessage">
            <p>Aucun document disponible.</p>
          </div>
          <div *ngIf="!Documents && !errorMessage">
            <p>Chargement des documents...</p>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
    <div class="col-lg-6 col-md-6">
      <mat-card
        class="daxa-card chat-card mb-25 border-radius bg-white border-none d-block"
      >
        <mat-card>
          <mat-card-content>
            <div class="chat-header d-md-flex align-items-center justify-content-between">
              <div class="user d-flex align-items-center">
                <div class="img position-relative">
                  <img src="images/users/user1.jpg" class="rounded-circle" alt="user-image">
                  <span class="active-status"></span>
                </div>
                <div class="title">
                  <span class="d-block fw-medium">
                    Negociation chat
                  </span>
                  <span class="d-block text-success">
                    Active Now
                  </span>
                </div>
              </div>
              <div class="buttons-list d-flex align-items-center">
                <button mat-button class="text-body">
                  <i class="material-symbols-outlined">
                    call
                  </i>
                </button>
                <button mat-button class="text-body">
                  <i class="material-symbols-outlined">
                    videocam
                  </i>
                </button>
                <button type="button" class="text-body" mat-button [matMenuTriggerFor]="chatHeaderMenu">
                  <i class="material-symbols-outlined">
                    more_horiz
                  </i>
                </button>
                <mat-menu #chatHeaderMenu="matMenu" class="card-header-menu" xPosition="before">
                  <button mat-menu-item>
                    Mute Chat
                  </button>
                  <button mat-menu-item>
                    Delete
                  </button>
                  <button mat-menu-item>
                    Block
                  </button>
                </mat-menu>
              </div>
            </div>
            <div class="border"></div>
            <div class="chat-body">
              <ul class="list-unstyled mb-0 mt-0">
                <li class="position-relative" *ngFor="let message of messages" [ngClass]="{'right': message.sender_id === senderId}">
                  <img src="images/users/user1.jpg" width="35" class="rounded-circle user" alt="user">
                  <div class="message">
                    <div>
                      <p>
                        {{ message.prenom }} {{ message.nom }}: {{ message.role }}
                      </p>
                    </div>
                    <div>
                      <p>
                        {{ message.contenu }}
                      </p>
                    </div>
                  </div>
                  <span class="time d-block text-muted">
                    {{ message.dateEnvoi | date:'HH:mm a' }}
                  </span>
                </li>
              </ul>
            </div>
            <div class="chat-footer border-radius d-md-flex align-items-center">
              <div class="buttons-list d-flex align-items-center">
                <button mat-button class="text-body">
                  <i class="material-symbols-outlined">
                    sentiment_satisfied
                  </i>
                </button>
                <button mat-button class="text-body" (click)="fileInput.click()">
                  <i class="material-symbols-outlined">
                    attach_file
                  </i>
                </button>
                <input type="file" #fileInput style="display: none;" (change)="handleFileInput($event)">
                <button mat-button class="text-body">
                  <i class="material-symbols-outlined">
                    mic_none
                  </i>
                </button>
                <button mat-button class="text-body">
                  <i class="material-symbols-outlined">
                    image
                  </i>
                </button>
              </div>
              <form class="position-relative" [formGroup]="messageForm" (ngSubmit)="sendMessage()">
                <mat-form-field>
                  <mat-label>Type something....</mat-label>
                  <input matInput formControlName="contenu">
                </mat-form-field>
                <button mat-button type="submit" [disabled]="messageForm.invalid">
                  <i class="material-symbols-outlined">
                    send
                  </i>
                </button>
              </form>
            </div>
          </mat-card-content>
        </mat-card>
      </mat-card>
    </div>
  </div>
              <button class="site-button radius-no" (click)="goNegociation()">NegociationList</button>  
          </div>
      </div>
      </div>
      
  <app-footer13></app-footer13>
  
</div>