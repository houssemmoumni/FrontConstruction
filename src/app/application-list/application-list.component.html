<div class="breadcrumb-card mb-4">
    <h5 class="mb-0">Applications List</h5>
    <ol class="breadcrumb list-unstyled mt-0 mb-0 pl-0">
      <li class="breadcrumb-item position-relative">
        <a routerLink="/" class="d-inline-block position-relative">
          <i class="ri-home-8-line"></i>
          Dashboard
        </a>
      </li>
      <li class="breadcrumb-item position-relative">Applications</li>
      <li class="breadcrumb-item position-relative">List</li>
    </ol>
  </div>

  <div class="d-flex justify-content-between mb-4">
    <div class="search-bar">
      <mat-form-field appearance="outline">
        <input matInput [(ngModel)]="searchText" (ngModelChange)="applyFilter()"
               placeholder="Search by name, email or job">
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
    </div>

    <div class="status-filter">
      <mat-form-field appearance="outline">
        <mat-select [(ngModel)]="selectedStatus" (ngModelChange)="applyFilter()"
                    placeholder="Filter by status">
          <mat-option value="ALL">All</mat-option>
          <mat-option value="ACCEPTED">Accepted</mat-option>
          <mat-option value="REJECTED">Rejected</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </div>

  <div class="table-responsive">
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Full Name</th>
          <th>Email</th>
          <th>Job Offer</th>
          <th>Status</th>
          <th>Resume</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let application of paginatedApplications" [id]="'app-' + application.id">
          <td>{{ application.candidate.firstName }} {{ application.candidate.lastName }}</td>
          <td>{{ application.candidate.email }}</td>
          <td>{{ application.jobOffer.title }}</td>
          <td>
            <span [ngClass]="{
              'text-success': application.status === 'ACCEPTED',
              'text-danger': application.status === 'REJECTED'
            }">
              {{ application.status }}
            </span>
          </td>
          <td>
            <button *ngIf="application.resume"
                    class="btn btn-primary"
                    (click)="downloadResume(application.resume, application.candidate.firstName + '_' + application.candidate.lastName)">
              Download CV
            </button>
            <span *ngIf="!application.resume">No CV</span>
          </td>
          <td>
            <div class="d-flex flex-wrap gap-1">
              <button class="btn btn-success" (click)="updateStatus(application.id, 'ACCEPTED')">
                Accept
              </button>
              <button class="btn btn-danger" (click)="updateStatus(application.id, 'REJECTED')">
                Reject
              </button>
              <button class="btn btn-warning" (click)="nommer(application.id)">
                Nominate
              </button>
              <button *ngIf="application.interviewPassed"
                      class="btn btn-info"
                      (click)="generateContract(application.id)">
                <i class="ri-file-text-line"></i> Generate Contract
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <mat-paginator [length]="filteredApplications.length"
                 [pageSize]="pageSize"
                 [pageSizeOptions]="[5, 10, 25, 100]"
                 (page)="onPageChange($event)">
  </mat-paginator>

  <div *ngIf="filteredApplications.length === 0" class="alert alert-info mt-4">
    No applications found.
  </div>
